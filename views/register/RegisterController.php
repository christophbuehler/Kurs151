<?phpclass RegisterController extends Controller {    function init() {        // assign page name        $this->smarty->assign('test', "das ist ein test...");        $id = 10;        if (Session::get('loggedIn')) {            header('location: ' . MAIN_VIEW);        }    }    function check_registration() {        // ensure user is logged out        if (Session::get('loggedIn')) {            Session::set('loggedIn', false);        }        // required fields        if (!isset($_POST['register-name'])) return array(            'code' => 1,            'msg' => "No username entered."        );        if (!isset($_POST['register-pass']))return array(            'code' => 1,            'msg' => "No password entered."        );        if (!isset($_POST['register-pass-rep']))return array(            'code' => 1,            'msg' => "Please repeat the password."        );        $login = stripslashes($_POST['register-name']);        $pass = $_POST['register-pass'];        $passRep = $_POST['register-pass-rep'];        $email = stripslashes(isset($_POST['register-email']) ? $_POST['register-email'] : '');        // login too short        if (strlen($login) < 5) return array(            'code' => 1,            'msg' => "Username has to be at least five characters in length"        );        // password too short        if (strlen($pass) < 5) return array(            'code' => 1,            'msg' => "Password has to be at least five characters in length"        );        // passwords don't match        if ($pass != $passRep) return array(            'code' => 1,            'msg' => "Passwords don't match."        );        // database        $db = $this->model->db;        // check if username already used        $sth = $db->prepare("SELECT * FROM user WHERE login = :login");        $sth->execute(array(            ':login' => $login        ));        $count = $sth->rowCount();        // username already in use        if ($count > 0) return array(            'code' => 1,            'msg' => "Username already in use."        );        // register query        $sth = $db->prepare("INSERT INTO user (login, password, email) VALUES (            :login, :password, :email)");        $sth->execute(array(            ':login' => $login,            ':password' => $pass,            ':email' => $email        ));        $count = $sth->rowCount();        // bad registration        if ($count == 0) return array(            'code' => 1,            'msg' => "Bad registration."        );        Session::set('loggedIn', true);        Session::set('userId', $db->lastInsertId());        Session::set('login', $login);        // Session::set('role', $result['rechte_gruppe_id']);        return array(            'code' => 0,            'msg' => "Registration successful."        );    }    function test() {        echo '{ "name" : "Urs", "age" : "92" }';    }}